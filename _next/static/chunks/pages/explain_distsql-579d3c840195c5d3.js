(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80],{71718:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/explain_distsql",function(){return n(17404)}])},44527:function(e,t,n){"use strict";var i=n(85893),o=n(40639);n(67294),t.Z=function(e){let{children:t}=e;return(0,i.jsx)(o.xv,{mb:2,textColor:"blue.500",fontWeight:"semibold",lineHeight:"6",children:t})}},17404:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Explain}});var i=n(82729),o=n(85893),a=n(40639),r=n(74995),l=n(47741),s=n(67294),d=n(44527),c=n(69647),u=n(56022),p=n(5100),h=n(65362),x=n(94556),g=n(39580),_=n(79855);function _templateObject(){let e=(0,i._)(["\n  font-family: sans-serif;\n  text-align: left;\n"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,i._)(["\n  width: 100%;\n  height: 80vh;\n"]);return _templateObject1=function(){return e},e}let f=(0,x.ZP)(a.xu)(_templateObject()),b=(0,x.ZP)(a.xu)(_templateObject1()),j={x:200,y:100},m={node:g.default};function Explain(){let[e,t]=(0,s.useState)(""),[n,i]=(0,s.useState)(!1),[x,g]=(0,s.useState)([]),[v,y]=(0,s.useState)([]);return(0,o.jsx)(s.Fragment,{children:(0,o.jsxs)(a.xu,{p:3,children:[(0,o.jsx)(d.Z,{children:"Distributed Plan Explain"}),(0,o.jsxs)(a.Kq,{direction:"row",spacing:4,align:"center",children:[(0,o.jsx)(r.g,{name:"input json",placeholder:"Explain",value:e,onChange:e=>{t(e.target.value),i(!0)},style:{width:"1000px",height:"100px"}}),(0,o.jsx)(l.zx,{colorScheme:"blue",onClick:()=>{if(!n)return;let t=JSON.parse(e);var o=function(e){var t=[],n=[],i=e.stages,o=new Set,a={},r=[];let l=e.root_stage_id.toString();for(let[e,l]of Object.entries(i)){let i=l.root;a[e]=i.plan_node_id;var s={background:"linear-gradient(".concat("hsl("+360*Math.random()+","+(25+70*Math.random())+"%,"+(85+10*Math.random())+"%)",", white, white)"),height:50,width:150,border:"0.5px solid black",padding:"5px","border-radius":"5px"},d={id:i.plan_node_id.toString(),data:{label:"#".concat(i.plan_node_id," ").concat(i.plan_node_type),stage:e,content:Object.values(i.schema)},position:j,type:"node",style:s};null!=i.source_stage_id&&r.push([i.plan_node_id,i.source_stage_id]),o.add(d.id),function parseSubElements(e,t,n,i,o,a,r){if(0!=e.children.length)for(var l=0;l<e.children.length;l++){let c=e.children[l];var s={id:"e".concat(e.plan_node_id,"-").concat(c.plan_node_id),source:e.plan_node_id.toString(),target:c.plan_node_id.toString(),type:"smoothstep"};if(o.push(s),!a.has(c.plan_node_id)){var d={id:c.plan_node_id.toString(),data:{label:"#".concat(c.plan_node_id," ").concat(c.plan_node_type),stage:t,content:Object.values(c.schema)},position:j,type:"node",style:n};null!=c.source_stage_id&&r.push([c.plan_node_id,c.source_stage_id]),parseSubElements(c,t,n,i,o,a,r),i.push(d)}}}(i,e,s,t,n,o,r),t.push(d)}for(var c=0;c<r.length;c++){var u=r[c][0],p=a[r[c][1].toString()],h={id:"e".concat(p,"-").concat(u),source:u.toString(),target:p.toString(),type:"smoothstep"};n.push(h)}return!function(e,t,n,i){let o=new Map;e.forEach(e=>{o.set(e.id,[{id:e.id,children:[]},e])}),t.forEach(e=>{let t=o.get(e.source)[0],n=o.get(e.target)[0];t.children.push(n)});var a=o.get(n[i].toString())[0],r=_.bT9(a),l=_.G_s().nodeSize([60,180]);let s=l(r);s.each(e=>{let t=o.get(e.data.id)[1];void 0!=t&&(t.position={x:e.y,y:e.x})})}(t,n,a,l),{node:t,edge:n}}(t);y(o.edge),g(o.node),i(!1)},style:{width:"80px",height:"100px"},children:"Click"})]}),(0,o.jsx)(f,{fluid:!0,children:(0,o.jsx)(b,{children:(0,o.jsxs)(c.ZP,{nodes:x,edges:v,nodeTypes:m,children:[(0,o.jsx)(u.Z,{}),(0,o.jsx)(p.i,{}),(0,o.jsx)(h.Z,{color:"#aaa",gap:16})]})})})]})})}},39580:function(e,t,n){"use strict";n.r(t);var i=n(85893),o=n(40639),a=n(67498),r=n(63679),l=n(67294),s=n(69647),d=n(90336);let c=(0,r.ZP)(()=>n.e(171).then(n.t.bind(n,55171,23))),u={background:"#FFFFFF"};t.default=function(e){let{data:t}=e;return void 0===t||void 0===t.label?(0,i.jsx)(l.Fragment,{}):(0,i.jsxs)(o.xu,{children:[(0,i.jsxs)(a.J2,{isLazy:!0,placement:"top",children:[(0,i.jsx)(a.xo,{contentStyle:u,children:(0,i.jsxs)(o.xu,{zIndex:"0",children:[(0,i.jsx)(o.xv,{fontSize:"8px",textAlign:"right",color:"LightSlateGray",children:t.stage}),(0,i.jsxs)(o.xv,{fontSize:"14px",textAlign:"center",children:[t.label," "]})]})}),(0,i.jsx)(o.xu,{zIndex:"popover",children:(0,i.jsxs)(a.yk,{children:[(0,i.jsx)(a.QH,{}),(0,i.jsx)(o.xu,{sx:{"&::-webkit-scrollbar":{width:"16px",borderRadius:"8px",backgroundColor:"rgba(0, 0, 0, 0.05)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0, 0, 0, 0.05)"}},overflowX:"auto",maxHeight:"400px",children:(0,i.jsx)(c,{src:t.content,name:!1,displayDataTypes:!1})})]})})]}),(0,i.jsx)(s.HH,{type:"target",position:d.P.Left}),(0,i.jsx)(s.HH,{type:"source",position:d.P.Right})]})}}},function(e){e.O(0,[770,476,591,323,855,452,977,774,888,179],function(){return e(e.s=71718)}),_N_E=e.O()}]);